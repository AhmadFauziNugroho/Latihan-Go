<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="utf-8" />
    <title>Mini Inventory Produk</title>
    <style>
      body {
        font-family: Arial;
        max-width: 800px;
        margin: 20px auto;
      }
      input,
      button {
        margin: 5px;
        padding: 8px;
      }
      table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
      }
      th,
      td {
        border: 1px solid #ccc;
        padding: 8px;
        text-align: left;
      }
    </style>
  </head>
  <body>
    <h1>Inventory Produk</h1>
    <div>
      <input id="name" placeholder="Nama Produk" />
      <input id="price" type="number" placeholder="Harga" />
      <input id="stock" type="number" placeholder="Stok" />
      <button onclick="saveProduct()">Simpan</button>
    </div>

    <table>
      <thead>
        <tr>
          <th>ID</th>
          <th>Nama</th>
          <th>Harga</th>
          <th>Stok</th>
          <th>Aksi</th>
        </tr>
      </thead>
      <tbody id="tbody"></tbody>
    </table>

    <script>
      const API = "http://localhost:8080/api/products";

      async function loadProducts() {
        const res = await fetch(API);
        const data = await res.json();
        document.getElementById("tbody").innerHTML = data
          .map(
            (p) => `
    <tr>
      <td>${p.id}</td>
      <td>${p.name}</td>
      <td>${p.price}</td>
      <td>${p.stock}</td>
      <td>
        <button onclick="deleteProduct(${p.id})">Hapus</button>
      </td>
    </tr>
  `
          )
          .join("");
      }

      async function saveProduct() {
        const name = document.getElementById("name").value;
        const price = parseFloat(document.getElementById("price").value);
        const stock = parseInt(document.getElementById("stock").value);

        await fetch(API, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ name, price, stock }),
        });
        loadProducts();
      }

      async function deleteProduct(id) {
        await fetch(`${API}/${id}`, { method: "DELETE" });
        loadProducts();
      }

      loadProducts();
    </script>
  </body>
</html>
